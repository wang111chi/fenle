version: '2'
services:
  test:
    build:
      context: ../../..
      dockerfile: api/docker/test/Dockerfile
    volumes:
     - ../../../config_global:/fenle/config_global
     - ../../config:/fenle/api/config
     - ../../logs:/fenle/api/logs
    entrypoint: ./wait-for-mysql.py pytest
    depends_on:
     - mysql
  mysql:
    build:
      context: ../../../docker/
      dockerfile: Dockerfile-mysql
    environment:
      - MYSQL_ROOT_PASSWORD=123456
      - MYSQL_DATABASE=fenle
