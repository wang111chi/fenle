<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html" charset="utf-8">
	<meta content="yes" name="apple-mobile-web-app-cacpable">
	<meta content="yes" name="apple-touch-fullscreen">
	<meta content="telephone=no,email=no" name="format-detection">
	<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
	<title>分期消费</title>
	<link rel="stylesheet" type="text/css" href="{{ config.STATIC_URL_PATH }}/css/common.css">
</head>
<body>
	<div class="mask"></div>
	<div class="error_area">
		<p class="error_content"></p>
		<a class="error_button">确定</a>
	</div>

	<div class="navbar-bg">
		<div class="navbar">
			  <img src="{{ config.STATIC_URL_PATH }}/img/logo.png" />
			<h1>测试</h1>
			<div class="info">
				<span>登录ID</span>
				<a class="out" href="#">退出</a>
			</div>
		</div>
	</div>

	<div class="content">
		<div class="aside">
			<ul>
				<li><a href="1_jifen.html">纯积分消费</a></li>
				<li><a href="2_jifen_xianjin.html">积分+现金消费</a></li>
				<li><a href="3_dinggou.html">无卡订购消费</a></li>
				<li class="active"><a href="4_fenqi.html">分期消费</a></li>
				<li><a href="5_yushou1.html">预授权-预授</a></li>
				<li><a href="5_yushou2.html">预授权-实际</a></li>
				<li><a href="6_liushui.html">业务流水</a></li>
			</ul>
		</div>

		<div class="section">
			<h2>分期消费</h2>
			<form class="pay-form" autocomplete="off">

				<!-- form -->
				<div class="form-item nec">
					<span class="label">交易金额</span>
					<input type="text" placeholder="消费金额" id="amount">
				</div>

				<div class="form-item">
					<span class="label">期数</span>
					<select id="period">
						<option value="0"></option>
						<option value="3">3期</option>
						<option value="6">6期</option>
						<option value="12">12期</option>
						<option value="24">24期</option>
					</select>
				</div>

				<div class="form-item nec">
					<span class="label">有效期</span>
					<input type="text" placeholder="2002" id="valid_date">
				</div>

				<div class="form-item nec">
					<span class="label">卡号</span>
					<input type="text" placeholder="信用卡卡号" id="bankacc_no">
				</div>
				<div class="form-item nec">
					<span class="label">手机号</span>
					<input type="text" placeholder="预留手机号" id="mobile">
					<input type="button" value="发送验证码" id="send_captcha">
				</div>
				<div class="form-item nec">
					<span class="label">短信验证码</span>
					<input type="text" placeholder="短信验证码" id="captcha">
				</div>

				<input type="button" value="提交" class="blue-btn mg" id="submit">
			</form>
			<div id="feedback"></div>
		</div>
	</div>
	<script type="text/javascript" src="{{ config.STATIC_URL_PATH }}/js/lib/jquery.min.js"></script>
	<script type="text/javascript" src="{{ config.STATIC_URL_PATH }}/js/common.js"></script>
	<script type="text/javascript">

		var return_data = {};

		$(document).ready(function(){

			// 1. 发送验证码
			$('#send_captcha').click(function(){

				return_data = {};

				// 1-1 获取要素
				var amount = $('#amount').val();
				var period = $('#period').val();
				var bankacc_no = $('#bankacc_no').val();
				var valid_date = $('#valid_date').val();
				var mobile = $('#mobile').val();
				var captcha_data = {'amount':amount, 'bankacc_no':bankacc_no, 'period':period, 'valid_date':valid_date, 'mobile':mobile};

				// 1-2 post
				sendCaptcha('/sms/send', captcha_data);
			});

			// 2. 提交
			$('#submit').click(function(){

				// 2-1 获取要素
				var amount = $('#amount').val();
				var period = $('#period').val();
				var bankacc_no = $('#bankacc_no').val();
				var valid_date = $('#valid_date').val();
				var mobile = $('#mobile').val();
				var captcha = $('#captcha').val();

				// 2-2 合并发送验证码返回data
				var submit_data = $.extend(return_data, {'amount':amount, 'bankacc_no':bankacc_no, 'period':period, 'valid_date':valid_date, 'mobile':mobile, 'captcha':captcha});

				// 2-3 post
				submitForm('/layaway/trade', submit_data);
			});

			// 3. 绑定确认按钮
			$('.error_button').click(function(){
				hideBox();
			});

		});
	</script>
</body>
</html>
